syntax = "proto3";

package model;
option go_package = "github.com/zoobc/zoobc-core/common/model";

import "model/pagination.proto";

message MultiSignatureInfo {
    uint32 MinimumSignatures = 1;
    int64 Nonce = 2 [ jstype = JS_STRING ];
    string MultisigAddress = 3;
    uint32 BlockHeight = 4;
    bool Latest = 5;
    repeated string Addresses = 6;
}

// represent the signature posted by account
message SignatureInfo {
    bytes TransactionHash = 1;
    map<string, bytes> Signatures = 2; 
}
// represent the multi signature's participant account addresses
message MultiSignatureParticipant {
    string MultiSignatureAddress = 1;
    string AccountAddress = 2;
    uint32 AccountAddressIndex = 3;
    bool Latest = 4;
    uint32 BlockHeight = 5;
}
// represent the pending signature counter stored by node for multi-signature transaction
message PendingSignature {
    bytes TransactionHash = 1;
    string AccountAddress = 2;
    bytes Signature = 3;
    uint32 BlockHeight = 4;
    bool Latest = 5;
}

// represent transaction inside multisig body
message PendingTransaction {
    string SenderAddress = 1;
    bytes TransactionHash = 2;
    bytes TransactionBytes = 3;
    PendingTransactionStatus Status = 4;
    uint32 BlockHeight = 5;
    bool Latest = 6;
}

enum PendingTransactionStatus {
    PendingTransactionPending = 0;
    PendingTransactionExecuted = 1;
    PendingTransactionNoOp = 2;
    PendingTransactionExpired = 3;
}

// API model

message GetPendingTransactionsRequest {
    string SenderAddress = 1;
    PendingTransactionStatus Status = 2;
    Pagination Pagination = 3;
}

message GetPendingTransactionsResponse {
    // Number of item in current page
    uint32 Count = 1;
    // Starting page
    uint32 Page = 2;
    // content of the request
    repeated PendingTransaction PendingTransactions = 3;
}

message GetPendingTransactionDetailByTransactionHashRequest {
    // hex of transaction hash
    string TransactionHashHex = 1;
}

message GetPendingTransactionDetailByTransactionHashResponse {
    PendingTransaction PendingTransaction = 1;
    repeated PendingSignature PendingSignatures = 2;
    MultiSignatureInfo MultiSignatureInfo = 3;
}

message GetMultisignatureInfoRequest {
    string MultisigAddress = 1;
    Pagination Pagination = 2;
}

message GetMultisignatureInfoResponse {
    // Number of item in current page
    uint32 Count = 1;
    // Starting page
    uint32 Page = 2;
    // content of the request
    repeated MultiSignatureInfo MultisignatureInfo = 3;
}

message GetMultisigAddressByParticipantAddressRequest {
    string ParticipantAddress = 1;
    Pagination Pagination = 2;
}

message GetMultisigAddressByParticipantAddressResponse {
    // Total of participant address
    uint32 Total = 1;
    // content of the request
    repeated string MultiSignAddresses = 2; 
}

message GetPendingTransactionsByHeightRequest {
    // Starting Height (inclusive) of request
    uint32 FromHeight = 1;
    // Ending Height (inclusive) of request
    uint32 ToHeight = 2;
}

message GetPendingTransactionsByHeightResponse {
    // List of pending transaction within requested height
    repeated PendingTransaction PendingTransactions = 1;
}

message GetMultisigAddressesByBlockHeightRangeRequest {
    uint32 FromBlockHeight = 1;
    uint32 ToBlockHeight = 2;
    Pagination Pagination = 3;
}

message GetMultisigAddressesByBlockHeightRangeResponse {
    // Number of item in current page
    uint32 Count = 1;
    // Starting page
    uint32 Page = 2;
    // content of the request
    repeated MultiSignatureInfo MultisignatureInfo = 3;
}